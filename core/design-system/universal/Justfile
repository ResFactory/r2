# Run regularly to update dependencies and perform similar maintenance
maintain: acquire-markdown-css

# Acquire the typical Markdown CSS which will be used by the client
acquire-markdown-css:
    #!/bin/bash
    SRC_URL=../../render/markdown/markdown.css.ts
    DEST_CSS=client-cargo/style/markdown.auto.css
    echo -e "/* Code generated. DO NOT EDIT. */" > "$DEST_CSS"
    echo -e "/* Generated by Justfile acquire-markdown-css from $SRC_URL [$(date -r $SRC_URL), $(stat -c%s $SRC_URL) bytes] by $(whoami) on $(hostname) */" >> "$DEST_CSS"
    deno run --unstable "$SRC_URL" >> "$DEST_CSS"

# Acquire github.com/optoolco/tonic lightweight Web Component Framework
acquire-tonic:
    #!/bin/bash
    set -euo pipefail
    SRC_URL=https://denopkg.com/optoolco/tonic@v13.3.5/src/index.js
    FINAL_URL=`curl -Ls -o /dev/null -w %{url_effective} $SRC_URL`
    TONIC="./client-cargo/script/tonic.js"
    echo -e "// deno-lint-ignore-file\n// deno-fmt-ignore-file\n// acquired on $(hostname) by $(whoami) at $(date) from $FINAL_URL\n" > "$TONIC"
    curl -s $FINAL_URL >> "$TONIC"
