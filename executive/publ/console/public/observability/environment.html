<!DOCTYPE html>
<!-- follow guidelines in README.md, we hide HTML to prevent flash of unstyled content (FOUC) -->
<html lang="en" style="display:none">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../path.actuate.css" />
    <script src="../path.actuate.js" type="module"></script>
    <script src="https://unpkg.com/ag-grid-community/dist/ag-grid-community.min.js"></script>
</head>

<!-- always use Semantic tags whenever possible (https://html.spec.whatwg.org/multipage/sections.html#the-article-element) -->

<body data-layout="auto">
    <!-- Here is our page's main content, should always be present because the auto-layout engine in Executive will build around it-->
    <main>
        <!-- It contains an article -->
        <article>
            <header>
                <h1>Environment Vairables</h1>
            </header> <!-- note use of <header> for article now, not page -->

            <p>These are all the environment variables known to the publication server (<code>pubctl.ts</code>)
                including sensitive values without masking. <em>Be careful about copy/pasting this content</em>.
                If you need a "sanitized" version of environment variables, there is a safer copy in
                <a href="./health.html">Health</a> (see <code>health.json</code>'s <code>build</code> component's
                <code>links</code>).
            </p>

            <div class="card">
                <div id="envVarsGrid" class="card-body ag-theme-alpine">
                </div>
            </div>
        </article>
    </main>

    <script type="module">
        import { humanPath } from "../deps.auto.js";

        document.addEventListener('DOMContentLoaded', function () {
            const envVarsGridElem = document.querySelector('#envVarsGrid');
            if (envVarsGridElem) {
                fetch("/workspace/inspect/env-vars.json").then(resp => resp.json()).then(envVars => {
                    const rowData = [];
                    for (const name of Object.keys(envVars).sort()) {
                        rowData.push({ name, value: envVars[name] });
                    }
                    const columnDefs = [
                        { field: "name" },
                        { field: "value" },
                    ];
                    const gridOptions = {
                        columnDefs: columnDefs,
                        rowData,
                        domLayout: 'autoHeight',
                        onGridReady: (event) => event.columnApi.autoSizeAllColumns(),
                    };
                    new agGrid.Grid(envVarsGridElem, gridOptions);
                })
            }
        });
    </script>
</body>

</html>