<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../path.actuate.css">
</head>

<body>
    <p style="font-weight: bolder;">
        <code class="rf-resource-inspectable-active">
            <span render-fx="({ target }) => target.innerHTML = path.editableClientLayoutTarget()?.fileName"
                render-hook-activate-page>
            </span>
        </code>
        Resource Route
    </p>
    <p>A <em>route</em> is the location of a page. Every page, whether it's navigable or hidden, has a route. Each route
        is comprised of one or more <em>route units</em>, which are the component's of the path where the page is
        located.</p>
    <p interpolate-fx="{ result: { inspectableRFUL: { route } } }" render-hook-activate-page>
        <b>${route.terminal?.label}</b> is a <code class="mime-type">${route.nature.mediaType}</code> page at route
        level
        ${route.terminal?.level + 1} and has ${route.units.length} ancestor${route.units.length == 1 ? '' : 's'}.
    </p>

    <details class="explore" open>
        <summary>Page Terminal Route Unit</summary>
        <p><code>clientLayout.route.terminal</code> is referred to as the <em>terminal route unit</em> because it
            'terminates' the path where this page is located.</p>
        <div render-fx="({ target, result: { inspectableRFUL: { route } } }) => path.populateObjectJSON(route.terminal, target)"
            render-hook-activate-page></div>
    </details>

    <details class="explore" open>
        <summary>Page Route</summary>
        <p><code>clientLayout.route</code> is referred to as the <em>route</em> because it describes the full path where
            this page is located. A single route is always comprised of one or more <em>route units</em>. The <em>route
                units</em> can be used to create <em>breadcrumbs</em> in the UI.</p>
        <div render-fx="({ target, result: { inspectableRFUL: { route } } }) => path.populateObjectJSON(route, target)"
            render-hook-activate-page></div>
    </details>

    <script type="module">
        import * as path from "../path.actuate.mjs";
        import * as srScriptDeps from "../server-runtime-script/deps.auto.js";
        import * as agG from "../aggrid.mjs";

        document.addEventListener('DOMContentLoaded', function () {
            // setup events, stores, and effects listeners so that we can be
            // as decoupled from business logic as possible

            const scriptsInventory = srScriptDeps.typicalScriptsInventory();
            window.srScriptRenderHook = (scriptID) => {
                const srScript = scriptsInventory.script(scriptID);
                return ({ target }) => path.watchPageFetchServerRuntimeScriptJsonFxDone({ srScript, autoActivate: true }, target.renderFx);
            }

            // check all the DOM elements to see if any events, stores, or effects
            // want to "hook" into the Effector instances; assume all domEffects'
            // eval()'s are done in this visiblity context
            path.prepareDomEffects({ evalJS: (js) => eval(js) });

            // all listeners are ready so let's activate the page and trigger the watchers
            path.activatePageFx();
        });
    </script>
</body>

</html>